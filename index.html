<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Draftlio - College Essay Helper</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background-color: #0a0a0a;
      color: #ffffff;
    }

    * {
      box-sizing: border-box;
    }

    /* Drawer */
    .drawer {
      position: fixed;
      left: -280px;
      top: 0;
      width: 280px;
      height: 100%;
      background: #1a1a1a;
      transition: left 0.3s ease;
      z-index: 1001;
      padding: 24px;
    }

    .drawer.open {
      left: 0;
    }

    .drawer-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1000;
    }

    .drawer-overlay.open {
      opacity: 1;
      pointer-events: all;
    }

    /* Marquee */
    @keyframes marquee {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .marquee-content {
      display: flex;
      animation: marquee 30s linear infinite;
    }

    .marquee-item {
      flex-shrink: 0;
      padding: 0 40px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .marquee-item img {
      filter: brightness(1.3) contrast(1.2) saturate(1.1);
      mix-blend-mode: lighten;
    }

    /* Robot animations */
    @keyframes robotPopIn {
      0% {
        opacity: 0;
        transform: translate(-50%, 20px) scale(0.8);
      }
      100% {
        opacity: 1;
        transform: translate(-50%, 0) scale(1);
      }
    }

    .robot-helper {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
      padding: 16px 24px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(124, 58, 237, 0.4);
      z-index: 999;
      animation: robotPopIn 0.4s ease-out;
      max-width: 400px;
      cursor: pointer;
    }

    .robot-helper.hidden {
      display: none;
    }

    /* Buttons */
    .btn-primary {
      background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
      color: white;
      padding: 12px 32px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      padding: 12px 32px;
      border-radius: 8px;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.2);
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    /* Inputs */
    input, textarea, select {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: white;
      padding: 12px;
      border-radius: 8px;
      width: 100%;
      font-family: inherit;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #7c3aed;
      background: rgba(124, 58, 237, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 200px;
    }

    select {
      background: #7c3aed;
      font-weight: 500;
      cursor: pointer;
    }

    select option {
      background: #1a1a1a;
    }

    /* Card */
    .main-card {
      background: #1a1a1a;
      border-radius: 16px;
      padding: 32px;
      max-width: 980px;
      margin: 0 auto;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
    }

    /* Feedback panel */
    .feedback-section {
      background: rgba(124, 58, 237, 0.1);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 12px;
      padding: 20px;
      margin-top: 16px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full"><!-- Drawer Overlay -->
  <div class="drawer-overlay" id="drawer-overlay" onclick="closeDrawer()"></div><!-- Drawer -->
  <div class="drawer" id="drawer">
   <div class="flex justify-between items-center mb-8">
    <h2 class="text-xl font-bold">Menu</h2><button onclick="closeDrawer()" class="text-2xl hover:text-violet-400">Ã—</button>
   </div>
   <nav class="flex flex-col gap-4"><a href="#" onclick="showPanel('essay'); closeDrawer(); return false;" class="text-lg hover:text-violet-400 transition-colors">ğŸ  Home</a> <a href="#" onclick="showPanel('chance'); closeDrawer(); return false;" class="text-lg hover:text-violet-400 transition-colors">ğŸ¯ Chance Me</a> <a href="#" onclick="showPanel('break'); closeDrawer(); return false;" class="text-lg hover:text-violet-400 transition-colors">â˜• Break Time</a>
   </nav>
  </div><!-- Main Layout -->
  <div class="w-full h-full flex flex-col"><!-- Header -->
   <header class="w-full border-b border-gray-800 bg-black">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
     <div class="flex items-center gap-4"><button onclick="openDrawer()" class="text-violet-500 hover:text-violet-400 text-2xl">â˜°</button>
      <div class="flex items-center gap-2 cursor-pointer" onclick="showPanel('essay')"><span class="text-2xl">âœ¨</span>
       <h1 id="brand-name" class="text-2xl font-bold bg-gradient-to-r from-violet-500 to-purple-400 bg-clip-text text-transparent">Draftlio</h1>
      </div>
     </div><button onclick="openMindBlossom()" class="w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-500 flex items-center justify-center hover:scale-110 transition-transform"> ğŸ§  </button>
    </div>
   </header><!-- Content -->
   <main class="flex-1 w-full overflow-y-auto px-6 py-8"><!-- Essay Panel -->
    <div id="panel-essay" class="panel-content">
     <div class="main-card">
      <h2 class="text-2xl font-bold mb-6">Essay Analysis</h2>
      <form id="essay-form">
       <div class="mb-4"><label class="block mb-2 font-semibold">This is my:</label> <select id="essay-category" class="mb-3"> <option value="personal">Personal Statement</option> <option value="commonapp">Common App</option> <option value="supplemental">Supplemental</option> <option value="other">Other</option> </select>
       </div>
       <div id="commonapp-prompts" class="mb-4 hidden"><label class="block mb-2 font-semibold">Common App Prompt:</label> <select id="commonapp-prompt"> <option>Some students have a background, identity, interest, or talent...</option> <option>The lessons we take from obstacles we encounter can be fundamental...</option> <option>Reflect on a time when you questioned or challenged a belief or idea...</option> <option>Reflect on something that someone has done for you that has made you happy...</option> <option>Discuss an accomplishment, event, or realization that sparked personal growth...</option> <option>Describe a topic, idea, or concept you find so engaging...</option> <option>Share an essay on any topic of your choice...</option> </select>
       </div>
       <div id="supplemental-fields" class="mb-4 hidden"><label class="block mb-2 font-semibold">College:</label> <input type="text" id="college-name" placeholder="e.g., Stanford University" class="mb-3"> <label class="block mb-2 font-semibold">Prompt:</label> <textarea id="supplemental-prompt" rows="3" placeholder="Paste the supplemental prompt here"></textarea>
       </div>
       <div class="mb-4"><label class="block mb-2 font-semibold">Your Essay:</label> <textarea id="essay-text" placeholder="Paste or write your essay here..." rows="12"></textarea>
        <div class="mt-2 text-sm text-gray-400"><span id="word-count">0</span> words
        </div>
       </div>
       <div class="flex gap-4"><button type="submit" class="btn-primary flex-1"> <span id="analyze-button-text">Analyze with Draftlio</span> </button> <button type="button" onclick="clearEssayForm()" class="btn-secondary">Clear</button>
       </div>
      </form>
      <div id="essay-feedback" class="hidden mt-6">
       <h3 class="text-xl font-bold mb-4">Analysis Results</h3>
       <div class="feedback-section mb-4">
        <h4 class="font-bold text-violet-400 mb-2">ğŸ“Š Big Picture</h4>
        <p id="feedback-bigpicture"></p>
       </div>
       <div class="feedback-section mb-4">
        <h4 class="font-bold text-violet-400 mb-2">ğŸ—ï¸ Structure</h4>
        <p id="feedback-structure"></p>
       </div>
       <div class="feedback-section mb-4">
        <h4 class="font-bold text-violet-400 mb-2">ğŸ¯ Specificity</h4>
        <p id="feedback-specificity"></p>
       </div>
       <div class="feedback-section">
        <h4 class="font-bold text-violet-400 mb-2">âœï¸ Sentence Level</h4>
        <p id="feedback-sentence"></p>
       </div>
      </div>
     </div>
    </div><!-- Chance Me Panel -->
    <div id="panel-chance" class="panel-content hidden">
     <div class="main-card">
      <h2 class="text-2xl font-bold mb-6">Chance Me Calculator</h2>
      <form id="chance-form">
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div><label class="block mb-2 font-semibold">Target College:</label> <input type="text" id="target-college" placeholder="e.g., MIT">
        </div>
        <div><label class="block mb-2 font-semibold">GPA:</label> <input type="text" id="gpa" placeholder="e.g., 3.8">
        </div>
        <div><label class="block mb-2 font-semibold">GPA Scale:</label> <select id="gpa-scale"> <option>4.0</option> <option>4.3</option> <option>4.5</option> <option>5.0</option> <option>100</option> <option>12.0</option> <option>Other</option> </select>
        </div>
        <div><label class="block mb-2 font-semibold">SAT Score:</label> <input type="text" id="sat" placeholder="e.g., 1450">
        </div>
        <div><label class="block mb-2 font-semibold">ACT Score:</label> <input type="text" id="act" placeholder="e.g., 32">
        </div>
        <div><label class="block mb-2 font-semibold">Intended Major:</label> <input type="text" id="major" placeholder="e.g., Computer Science">
        </div>
       </div>
       <div class="mb-4"><label class="block mb-2 font-semibold">Extracurriculars:</label> <textarea id="ecs" rows="3" placeholder="List your key activities, leadership roles, sports, clubs..."></textarea>
       </div>
       <div class="mb-4"><label class="block mb-2 font-semibold">Awards &amp; Honors:</label> <textarea id="awards" rows="3" placeholder="Academic awards, competitions, recognitions..."></textarea>
       </div>
       <div class="mb-4"><label class="block mb-2 font-semibold">Additional Info:</label> <textarea id="additional" rows="3" placeholder="Special circumstances, unique experiences, context..."></textarea>
       </div>
       <div class="flex gap-4"><button type="submit" class="btn-primary flex-1">Analyze Chance (Demo)</button> <button type="button" onclick="clearChanceForm()" class="btn-secondary">Clear</button>
       </div>
      </form>
      <div id="chance-feedback" class="hidden mt-6">
       <div class="feedback-section">
        <h3 class="text-xl font-bold text-violet-400 mb-4">ğŸ“ˆ Your Profile Summary</h3>
        <div id="chance-summary" class="mb-4"></div>
        <h4 class="font-bold mb-2">Quick Tips:</h4>
        <ul id="chance-tips" class="list-disc list-inside space-y-2"></ul>
       </div>
      </div>
     </div>
    </div><!-- Break Time Panel -->
    <div id="panel-break" class="panel-content hidden">
     <div class="main-card">
      <h2 class="text-2xl font-bold mb-6">â˜• Break Time</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
       <div class="feedback-section">
        <h3 class="text-lg font-bold mb-3">ğŸ§˜ Quick Stretch</h3>
        <p class="text-sm text-gray-300 mb-4">Take a 1-minute break to stretch and reset</p><button id="stretch-button" onclick="toggleStretch()" class="btn-primary w-full">Start 1-Min Stretch</button>
        <div id="stretch-timer" class="hidden mt-4 text-center">
         <div class="text-4xl font-bold text-violet-400">
          <span id="stretch-countdown">60</span>s
         </div>
         <p class="text-sm mt-2">Breathe and stretch!</p>
        </div>
       </div>
       <div class="feedback-section">
        <h3 class="text-lg font-bold mb-3">ğŸ«§ Breathing Bubble</h3>
        <p class="text-sm text-gray-300 mb-4">Follow the bubble to calm your mind</p><button id="breathing-button" onclick="toggleBreathing()" class="btn-primary w-full">Start Breathing</button>
        <div id="breathing-container" class="hidden mt-6" style="display: flex; flex-direction: column; align-items: center; gap: 12px;">
         <div id="breathing-circle" style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #7c3aed, #a78bfa); transition: all 4s ease-in-out;"></div>
         <p id="breathing-text" class="text-lg font-semibold text-violet-400">Breathe in...</p>
        </div>
       </div>
      </div>
      <div class="feedback-section mb-6">
       <h3 class="text-lg font-bold mb-3">ğŸ“ Quick Notes</h3><textarea id="break-notes" rows="6" placeholder="Jot down ideas, thoughts, or reminders..."></textarea>
      </div>
      <div class="feedback-section">
       <h3 class="text-lg font-bold mb-3">ğŸ® Scribbles' Flappy Adventure</h3>
       <p class="text-sm text-gray-300 mb-4">Help Scribbles fly through the obstacles! Click or press Space to flap.</p>
       <div style="position: relative; width: 100%; max-width: 400px; margin: 0 auto; background: #0a0a0a; border-radius: 8px; overflow: hidden;">
        <canvas id="game-canvas" width="400" height="500" style="display: block; width: 100%; height: auto;"></canvas>
        <div id="game-over-screen" style="position: absolute; inset: 0; background: rgba(0,0,0,0.8); display: none; flex-direction: column; align-items: center; justify-content: center; gap: 16px;">
         <h3 class="text-2xl font-bold">Game Over!</h3>
         <p class="text-xl">Score: <span id="final-score">0</span></p><button onclick="restartGame()" class="btn-primary">Play Again</button>
        </div>
       </div>
      </div>
     </div>
    </div>
   </main><!-- Footer Marquee -->
   <footer class="w-full border-t border-gray-800 bg-black py-4 overflow-hidden">
    <div class="marquee-content">
     <div class="marquee-item"><img src="https://bbdesignsss.com/cdn/shop/files/10EAAE06-D34C-429E-B1E4-C39CC5EBBAEC.jpg?v=1705196896" alt="Harvard" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Harvard</span>
     </div>
     <div class="marquee-item"><img src="https://identity.stanford.edu/wp-content/uploads/sites/3/2020/07/block-s-right.png" alt="Stanford" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Stanford</span>
     </div>
     <div class="marquee-item"><img src="https://media.canva.com/v2/image-resize/format:PNG/height:155/quality:100/uri:ifs%3A%2F%2FM%2F6772d035-072b-4e7b-9bfa-4520de200ea6/watermark:F/width:250?csig=AAAAAAAAAAAAAAAAAAAAALUYkHrlU-RTKn5hJ4Ad_YD83mu6fCsQuQaJoWQE3lgm&amp;exp=1764938125&amp;osig=AAAAAAAAAAAAAAAAAAAAAPKtJHDZhX1VS5Ht7r4iRfjOB0KiB7BRZpBTPMM48bgE&amp;signer=media-rpc&amp;x-canva-quality=thumbnail_large" alt="MIT" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ MIT</span>
     </div>
     <div class="marquee-item"><img src="https://rfleadership.org/wp-content/uploads/2022/08/230-2307146_transparent-yale-university-logo-hd-png-download-removebg-preview.png" alt="Yale" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Yale</span>
     </div>
     <div class="marquee-item"><img src="https://chemistry.princeton.edu/wp-content/themes/princetonchem/images/princeton-university-logo-alt.svg" alt="Princeton" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Princeton</span>
     </div>
     <div class="marquee-item"><img src="https://media.canva.com/v2/image-resize/format:PNG/height:211/quality:100/uri:ifs%3A%2F%2FM%2F76ac410c-4c8d-4615-bc46-0b6561b9b009/watermark:F/width:239?csig=AAAAAAAAAAAAAAAAAAAAAFyCyYYf1A2QsJ2I-PM6rfyzUWsisl2InZXqb-bfNXCR&amp;exp=1764937826&amp;osig=AAAAAAAAAAAAAAAAAAAAANYsbshzPaqoympslP7fjtXQSy2Ps2YTdb-3idx_t9nA&amp;signer=media-rpc&amp;x-canva-quality=thumbnail_large" alt="Columbia" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Columbia</span>
     </div>
     <div class="marquee-item"><img src="https://branding.web-resources.upenn.edu/sites/default/files/styles/card_3x2/public/2022-03/UniversityofPennsylvania_FullLogo_RGB-4_0.png?h=ab080a2f&amp;itok=tu_jMFEm" alt="UPenn" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ UPenn</span>
     </div>
     <div class="marquee-item"><img src="https://1000logos.net/wp-content/uploads/2022/05/Brown-University-Logo.png" alt="Brown" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Brown</span>
     </div>
     <div class="marquee-item"><img src="https://i0.wp.com/biocars.uchicago.edu/wp-content/uploads/2019/05/cropped-logo.png?ssl=1" alt="UChicago" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ UChicago</span>
     </div>
     <div class="marquee-item"><img src="https://www.cmu.edu/brand/brand-guidelines/images/seal-4c-600x600-min.jpg" alt="CMU" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ CMU</span>
     </div>
     <div class="marquee-item"><img src="https://brand.gatech.edu/sites/default/files/inline-images/GTVertical_RGB.png" alt="Georgia Tech" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Georgia Tech</span>
     </div><!-- Duplicate for seamless loop -->
     <div class="marquee-item"><img src="https://bbdesignsss.com/cdn/shop/files/10EAAE06-D34C-429E-B1E4-C39CC5EBBAEC.jpg?v=1705196896" alt="Harvard" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Harvard</span>
     </div>
     <div class="marquee-item"><img src="https://identity.stanford.edu/wp-content/uploads/sites/3/2020/07/block-s-right.png" alt="Stanford" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Stanford</span>
     </div>
     <div class="marquee-item"><img src="https://media.canva.com/v2/image-resize/format:PNG/height:155/quality:100/uri:ifs%3A%2F%2FM%2F6772d035-072b-4e7b-9bfa-4520de200ea6/watermark:F/width:250?csig=AAAAAAAAAAAAAAAAAAAAALUYkHrlU-RTKn5hJ4Ad_YD83mu6fCsQuQaJoWQE3lgm&amp;exp=1764938125&amp;osig=AAAAAAAAAAAAAAAAAAAAAPKtJHDZhX1VS5Ht7r4iRfjOB0KiB7BRZpBTPMM48bgE&amp;signer=media-rpc&amp;x-canva-quality=thumbnail_large" alt="MIT" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ MIT</span>
     </div>
     <div class="marquee-item"><img src="https://rfleadership.org/wp-content/uploads/2022/08/230-2307146_transparent-yale-university-logo-hd-png-download-removebg-preview.png" alt="Yale" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Yale</span>
     </div>
     <div class="marquee-item"><img src="https://chemistry.princeton.edu/wp-content/themes/princetonchem/images/princeton-university-logo-alt.svg" alt="Princeton" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Princeton</span>
     </div>
     <div class="marquee-item"><img src="https://media.canva.com/v2/image-resize/format:PNG/height:211/quality:100/uri:ifs%3A%2F%2FM%2F76ac410c-4c8d-4615-bc46-0b6561b9b009/watermark:F/width:239?csig=AAAAAAAAAAAAAAAAAAAAAFyCyYYf1A2QsJ2I-PM6rfyzUWsisl2InZXqb-bfNXCR&amp;exp=1764937826&amp;osig=AAAAAAAAAAAAAAAAAAAAANYsbshzPaqoympslP7fjtXQSy2Ps2YTdb-3idx_t9nA&amp;signer=media-rpc&amp;x-canva-quality=thumbnail_large" alt="Columbia" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Columbia</span>
     </div>
     <div class="marquee-item"><img src="https://branding.web-resources.upenn.edu/sites/default/files/styles/card_3x2/public/2022-03/UniversityofPennsylvania_FullLogo_RGB-4_0.png?h=ab080a2f&amp;itok=tu_jMFEm" alt="UPenn" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ UPenn</span>
     </div>
     <div class="marquee-item"><img src="https://1000logos.net/wp-content/uploads/2022/05/Brown-University-Logo.png" alt="Brown" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Brown</span>
     </div>
     <div class="marquee-item"><img src="https://i0.wp.com/biocars.uchicago.edu/wp-content/uploads/2019/05/cropped-logo.png?ssl=1" alt="UChicago" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ UChicago</span>
     </div>
     <div class="marquee-item"><img src="https://www.cmu.edu/brand/brand-guidelines/images/seal-4c-600x600-min.jpg" alt="CMU" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ CMU</span>
     </div>
     <div class="marquee-item"><img src="https://brand.gatech.edu/sites/default/files/inline-images/GTVertical_RGB.png" alt="Georgia Tech" style="height: 40px; width: auto; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';"> <span style="display: none;">ğŸ“ Georgia Tech</span>
     </div>
    </div>
   </footer>
  </div><!-- Robot Helpers -->
  <div id="draftlio-robot" class="robot-helper hidden" onclick="dismissRobot('draftlio')">
   <div class="flex items-start gap-3">
    <div class="text-2xl">
     ğŸ¤–
    </div>
    <div>
     <div class="font-bold mb-1">
      Draftlio Helper
     </div>
     <div id="draftlio-message" class="text-sm">
      Hi! I'm here to help you craft amazing essays!
     </div>
    </div>
   </div>
  </div>
  <div id="breakbot-robot" class="robot-helper hidden" onclick="dismissRobot('breakbot')">
   <div class="flex items-start gap-3">
    <svg width="48" height="48" viewbox="0 0 48 48" style="flex-shrink: 0;"><!-- Scribbles the Robot --> <rect x="10" y="18" width="28" height="24" rx="4" fill="#a78bfa" /> <circle cx="19" cy="28" r="3" fill="#ffffff" /> <circle cx="29" cy="28" r="3" fill="#ffffff" /> <circle cx="19" cy="28" r="1.5" fill="#1a1a1a" /> <circle cx="29" cy="28" r="1.5" fill="#1a1a1a" /> <rect x="20" y="35" width="8" height="2" rx="1" fill="#ffffff" /> <rect x="22" y="12" width="4" height="6" fill="#7c3aed" /> <circle cx="24" cy="10" r="3" fill="#fbbf24" /> <rect x="6" y="24" width="4" height="8" rx="2" fill="#7c3aed" /> <rect x="38" y="24" width="4" height="8" rx="2" fill="#7c3aed" />
    </svg>
    <div>
     <div class="font-bold mb-1">
      Scribbles
     </div>
     <div id="breakbot-message" class="text-sm">
      Time for a quick break! Your brain will thank you.
     </div>
    </div>
   </div>
  </div>
  <script>
  // Call Draftlio backend (Gemini essay feedback)
async function analyzeEssayWithGemini({ text, wordCount, category, prompt, college }) {
  const res = await fetch("https://draftlio-api.vercel.app/api/draftlio", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      essayText: text,
      wordCount,
      category,
      prompt,
      college
    })
  });

  if (!res.ok) {
    throw new Error("API error");
  }

  const data = await res.json();
  return data.feedback; // { bigpicture, structure, specificity, sentence }
}

    const defaultConfig = {
      background_color: "#0a0a0a",
      card_color: "#1a1a1a",
      text_color: "#ffffff",
      primary_color: "#7c3aed",
      secondary_color: "#a78bfa",
      brand_name: "Draftlio",
      analyze_button_text: "Analyze with Draftlio",
      draftlio_helper_message: "Hi! I'm here to help you craft amazing essays!",
      breakbot_message: "Time for a quick break! Your brain will thank you.",
      font_family: "system-ui",
      font_size: 16
    };

    let submissions = [];
    let isSubmitting = false;
    let currentPanel = 'essay';
    let draftlioShown = false;
    let breakbotShown = false;
    let isTyping = false;
    let typingTimeout;
    let stretchInterval;
    let breathingTimeout;
    let isStretching = false;
    let isBreathing = false;

    // Data SDK Handler
    const dataHandler = {
      onDataChanged(data) {
        submissions = data;
      }
    };

    // Initialize SDKs
    async function initializeApp() {
      const dataResult = await window.dataSdk.init(dataHandler);
      if (!dataResult.isOk) {
        console.error("Failed to initialize data SDK");
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            const baseSize = config.font_size || defaultConfig.font_size;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = 'system-ui, -apple-system, sans-serif';

            document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
            document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
            
            const brandName = document.getElementById('brand-name');
            if (brandName) {
              brandName.textContent = config.brand_name || defaultConfig.brand_name;
            }

            const analyzeBtnText = document.getElementById('analyze-button-text');
            if (analyzeBtnText) {
              analyzeBtnText.textContent = config.analyze_button_text || defaultConfig.analyze_button_text;
            }

            const draftlioMsg = document.getElementById('draftlio-message');
            if (draftlioMsg) {
              draftlioMsg.textContent = config.draftlio_helper_message || defaultConfig.draftlio_helper_message;
            }

            const breakbotMsg = document.getElementById('breakbot-message');
            if (breakbotMsg) {
              breakbotMsg.textContent = config.breakbot_message || defaultConfig.breakbot_message;
            }

            const cards = document.querySelectorAll('.main-card');
            cards.forEach(card => {
              card.style.backgroundColor = config.card_color || defaultConfig.card_color;
            });
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.setConfig({ background_color: value });
                  }
                }
              },
              {
                get: () => config.card_color || defaultConfig.card_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.setConfig({ card_color: value });
                  }
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.setConfig({ text_color: value });
                  }
                }
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.setConfig({ primary_color: value });
                  }
                }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.setConfig({ secondary_color: value });
                  }
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ font_family: value });
                }
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ font_size: value });
                }
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["brand_name", config.brand_name || defaultConfig.brand_name],
            ["analyze_button_text", config.analyze_button_text || defaultConfig.analyze_button_text],
            ["draftlio_helper_message", config.draftlio_helper_message || defaultConfig.draftlio_helper_message],
            ["breakbot_message", config.breakbot_message || defaultConfig.breakbot_message]
          ])
        });
      }

      // Robot timers
      setTimeout(() => showDraftlioRobot(), 30000); // First time after 30s
      setInterval(() => showDraftlioRobot(), 1200000); // Every 20 min
    }

    // Drawer functions
    function openDrawer() {
      document.getElementById('drawer').classList.add('open');
      document.getElementById('drawer-overlay').classList.add('open');
    }

    function closeDrawer() {
      document.getElementById('drawer').classList.remove('open');
      document.getElementById('drawer-overlay').classList.remove('open');
    }

    // Panel switching
    function showPanel(panel) {
      document.querySelectorAll('.panel-content').forEach(p => p.classList.add('hidden'));
      document.getElementById(`panel-${panel}`).classList.remove('hidden');
      currentPanel = panel;

      if (panel === 'break' && !breakbotShown) {
        showBreakbotRobot();
        breakbotShown = true;
        setInterval(() => showBreakbotRobot(), Math.random() * 300000 + 300000); // 5-10 min
      }
    }

    // Open MindBlossom
    function openMindBlossom() {
      window.open('https://chatgpt.com', '_blank', 'noopener,noreferrer');
    }

    // Essay category change
    document.getElementById('essay-category').addEventListener('change', (e) => {
      const value = e.target.value;
      document.getElementById('commonapp-prompts').classList.add('hidden');
      document.getElementById('supplemental-fields').classList.add('hidden');

      if (value === 'commonapp') {
        document.getElementById('commonapp-prompts').classList.remove('hidden');
      } else if (value === 'supplemental') {
        document.getElementById('supplemental-fields').classList.remove('hidden');
      }
    });

    // Word counter
    const essayTextarea = document.getElementById('essay-text');
    const wordCountSpan = document.getElementById('word-count');

    essayTextarea.addEventListener('input', () => {
      isTyping = true;
      clearTimeout(typingTimeout);
      typingTimeout = setTimeout(() => { isTyping = false; }, 2000);

      const text = essayTextarea.value.trim();
      const words = text ? text.split(/\s+/).length : 0;
      wordCountSpan.textContent = words;
    });

    // Essay form submission
    document.getElementById('essay-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (isSubmitting) return;

      const text = essayTextarea.value.trim();
      const wordCount = text ? text.split(/\s+/).length : 0;

      if (wordCount < 50) {
        showToast('Please write at least 50 words for analysis.');
        return;
      }

      if (submissions.length >= 999) {
        showToast('Maximum limit of 999 submissions reached.');
        return;
      }

      isSubmitting = true;
      const submitBtn = document.querySelector('#essay-form button[type="submit"]');
      submitBtn.disabled = true;

     

     let feedback;
try {
  feedback = await analyzeEssayWithGemini({
    text,
    wordCount,
    category: document.getElementById('essay-category').value,
    prompt: document.getElementById('supplemental-prompt')?.value || document.getElementById('commonapp-prompt')?.value || '',
    college: document.getElementById('college-name')?.value || ''
  });
} catch (err) {
  console.error(err);
  showToast('Draftlio AI had an error. Try again.');
  isSubmitting = false;
  submitBtn.disabled = false;
  return;
}

      
      document.getElementById('feedback-bigpicture').textContent = feedback.bigpicture;
      document.getElementById('feedback-structure').textContent = feedback.structure;
      document.getElementById('feedback-specificity').textContent = feedback.specificity;
      document.getElementById('feedback-sentence').textContent = feedback.sentence;
      document.getElementById('essay-feedback').classList.remove('hidden');

      const category = document.getElementById('essay-category').value;
      let essayType = category;
      let prompt = '';
      let college = '';

      if (category === 'commonapp') {
        prompt = document.getElementById('commonapp-prompt').value;
      } else if (category === 'supplemental') {
        college = document.getElementById('college-name').value;
        prompt = document.getElementById('supplemental-prompt').value;
      }

      const submission = {
        id: `essay-${Date.now()}`,
        type: 'essay',
        essay_text: text,
        essay_type: essayType,
        prompt: prompt,
        college: college,
        word_count: wordCount,
        submitted_at: new Date().toISOString(),
        overall_score: 85,
        feedback: JSON.stringify(feedback),
        chance_data: ''
      };

      await window.dataSdk.create(submission);

      isSubmitting = false;
      submitBtn.disabled = false;
      showToast('Essay analyzed successfully!');
    });

    // Chance form submission
    document.getElementById('chance-form').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (isSubmitting) return;

      const targetCollege = document.getElementById('target-college').value.trim();
      const gpa = document.getElementById('gpa').value.trim();
      const sat = document.getElementById('sat').value.trim();

      if (!targetCollege || !gpa) {
        showToast('Please fill in at least target college and GPA.');
        return;
      }

      if (submissions.length >= 999) {
        showToast('Maximum limit of 999 submissions reached.');
        return;
      }

      isSubmitting = true;
      const submitBtn = document.querySelector('#chance-form button[type="submit"]');
      submitBtn.disabled = true;

      await new Promise(resolve => setTimeout(resolve, 1500));

      const chanceData = {
        college: targetCollege,
        gpa: gpa,
        gpaScale: document.getElementById('gpa-scale').value,
        sat: sat,
        act: document.getElementById('act').value,
        major: document.getElementById('major').value,
        ecs: document.getElementById('ecs').value,
        awards: document.getElementById('awards').value,
        additional: document.getElementById('additional').value
      };

      const analysis = generateChanceAnalysis(chanceData);
      
      document.getElementById('chance-summary').innerHTML = analysis.summary;
      document.getElementById('chance-tips').innerHTML = analysis.tips.map(tip => `<li>${tip}</li>`).join('');
      document.getElementById('chance-feedback').classList.remove('hidden');

      const submission = {
        id: `chance-${Date.now()}`,
        type: 'chance',
        essay_text: '',
        essay_type: '',
        prompt: '',
        college: targetCollege,
        word_count: 0,
        submitted_at: new Date().toISOString(),
        overall_score: 0,
        feedback: '',
        chance_data: JSON.stringify(chanceData)
      };

      await window.dataSdk.create(submission);

      isSubmitting = false;
      submitBtn.disabled = false;
      showToast('Chance analysis complete!');
    });

    // Clear forms
    function clearEssayForm() {
      document.getElementById('essay-form').reset();
      document.getElementById('essay-feedback').classList.add('hidden');
      wordCountSpan.textContent = '0';
      document.getElementById('commonapp-prompts').classList.add('hidden');
      document.getElementById('supplemental-fields').classList.add('hidden');
    }

    function clearChanceForm() {
      document.getElementById('chance-form').reset();
      document.getElementById('chance-feedback').classList.add('hidden');
    }

    // Toggle Stretch Timer
    function toggleStretch() {
      const button = document.getElementById('stretch-button');
      const timerDiv = document.getElementById('stretch-timer');
      
      if (isStretching) {
        // Stop stretch
        clearInterval(stretchInterval);
        isStretching = false;
        button.textContent = 'Start 1-Min Stretch';
        timerDiv.classList.add('hidden');
        document.getElementById('stretch-countdown').textContent = '60';
      } else {
        // Start stretch
        isStretching = true;
        button.textContent = 'Stop';
        let time = 60;
        timerDiv.classList.remove('hidden');
        const countdown = document.getElementById('stretch-countdown');

        clearInterval(stretchInterval);
        stretchInterval = setInterval(() => {
          time--;
          countdown.textContent = time;
          if (time <= 0) {
            clearInterval(stretchInterval);
            isStretching = false;
            showToast('Great job! Stretch complete.');
            timerDiv.classList.add('hidden');
            button.textContent = 'Start 1-Min Stretch';
            countdown.textContent = '60';
          }
        }, 1000);
      }
    }

    // Toggle Breathing
    function toggleBreathing() {
      const button = document.getElementById('breathing-button');
      const container = document.getElementById('breathing-container');
      const circle = document.getElementById('breathing-circle');
      const text = document.getElementById('breathing-text');
      
      if (isBreathing) {
        // Stop breathing
        clearTimeout(breathingTimeout);
        isBreathing = false;
        button.textContent = 'Start Breathing';
        container.classList.add('hidden');
        circle.style.width = '80px';
        circle.style.height = '80px';
        circle.style.opacity = '1';
      } else {
        // Start breathing
        isBreathing = true;
        button.textContent = 'Stop';
        container.style.display = 'flex';
        container.classList.remove('hidden');
        let breathCount = 0;
        let isInhale = true;

        function breatheCycle() {
          if (!isBreathing) return;
          
          if (breathCount >= 10) {
            showToast('Great breathing! Feel refreshed?');
            container.classList.add('hidden');
            circle.style.width = '80px';
            circle.style.height = '80px';
            circle.style.opacity = '1';
            breathCount = 0;
            isBreathing = false;
            button.textContent = 'Start Breathing';
            return;
          }

          if (isInhale) {
            circle.style.width = '120px';
            circle.style.height = '120px';
            circle.style.opacity = '1';
            text.textContent = 'Breathe in...';
          } else {
            circle.style.width = '80px';
            circle.style.height = '80px';
            circle.style.opacity = '0.6';
            text.textContent = 'Breathe out...';
            breathCount++;
          }

          isInhale = !isInhale;
          
          if (breathCount < 10 && isBreathing) {
            breathingTimeout = setTimeout(breatheCycle, 4000);
          }
        }

        breatheCycle();
      }
    }

    // Robots
    function showDraftlioRobot() {
      if (isTyping || currentPanel !== 'essay') return;
      const robot = document.getElementById('draftlio-robot');
      robot.classList.remove('hidden');
      setTimeout(() => {
        robot.classList.add('hidden');
      }, 6000);
    }

    function showBreakbotRobot() {
      if (currentPanel !== 'break') return;
      const robot = document.getElementById('breakbot-robot');
      robot.classList.remove('hidden');
      setTimeout(() => {
        robot.classList.add('hidden');
      }, 6000);
    }

    function dismissRobot(type) {
      document.getElementById(`${type}-robot`).classList.add('hidden');
    }

    // Feedback generators
    function generateEssayFeedback(text, wordCount) {
      return {
        bigpicture: `Your essay shows promise! With ${wordCount} words, you're ${wordCount < 400 ? 'a bit shortâ€”aim for 400-650' : wordCount > 650 ? 'over the limitâ€”trim to 650 max' : 'in the sweet spot'}. The central theme could be stronger. Make sure every paragraph connects back to your main message.`,
        structure: `Your essay has ${text.split(/[.!?]+/).length - 1} sentences. Consider varying sentence length and structure to create better rhythm. Start with a compelling hook, develop your story in the middle, and end with reflection that shows growth.`,
        specificity: `Use more concrete details and specific examples. Instead of saying "I learned a lot," describe the exact moment of realization. Show, don't tell! Replace general statements with vivid scenes that put the reader in your shoes.`,
        sentence: `Watch for repetitive sentence structures. Vary your sentence openings and lengths. Read your essay aloud to catch awkward phrasing. Check for passive voice and strengthen weak verbs.`
      };
    }

    function generateChanceAnalysis(data) {
      const tips = [
        `Strong academic profile with ${data.gpa} GPA. Continue maintaining high grades senior year.`,
        `${data.sat ? `SAT ${data.sat} is competitive. ` : ''}Consider taking subject tests if ${data.college} values them.`,
        `Extracurriculars show depth. Highlight leadership roles and impact in your essays.`,
        `${data.college} values authenticity. Let your genuine passion for ${data.major || 'your field'} shine through.`,
        `Strengthen your application with compelling recommendation letters and thoughtful essays.`
      ];

      return {
        summary: `<p class="mb-2">Applying to <strong>${data.college}</strong> for <strong>${data.major || 'Undeclared'}</strong></p>
                  <p class="mb-2">Academic Profile: GPA ${data.gpa} (${data.gpaScale} scale)${data.sat ? `, SAT ${data.sat}` : ''}${data.act ? `, ACT ${data.act}` : ''}</p>
                  <p class="text-sm text-gray-400">This is a demo analysis. Actual admissions depend on many holistic factors including essays, recommendations, demonstrated interest, and institutional needs.</p>`,
        tips: tips
      };
    }

    // Toast
    function showToast(message) {
      const toast = document.createElement('div');
      toast.textContent = message;
      toast.style.cssText = `
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        z-index: 1000;
        box-shadow: 0 4px 16px rgba(124, 58, 237, 0.4);
      `;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeDrawer();
      }
    });

    // Game Logic
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');
    let gameRunning = false;
    let gameScore = 0;
   let scribbles = {
  x: 80,
  y: 250,
  width: 40,
  height: 40,
  velocity: 0,
  gravity: 0.25,   // slower fall
  jump: -6         // smoother jump
};

   pipe.x -= 2;   // slower pipes

    let frameCount = 0;
    let gameInterval;

    function drawScribbles(x, y) {
      // Scribbles body
      ctx.fillStyle = '#a78bfa';
      ctx.fillRect(x + 6, y + 14, 28, 24);
      
      // Scribbles eyes
      ctx.fillStyle = '#ffffff';
      ctx.beginPath();
      ctx.arc(x + 15, y + 24, 3, 0, Math.PI * 2);
      ctx.arc(x + 25, y + 24, 3, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.fillStyle = '#1a1a1a';
      ctx.beginPath();
      ctx.arc(x + 15, y + 24, 1.5, 0, Math.PI * 2);
      ctx.arc(x + 25, y + 24, 1.5, 0, Math.PI * 2);
      ctx.fill();
      
      // Scribbles smile
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(x + 16, y + 31, 8, 2);
      
      // Scribbles antenna
      ctx.fillStyle = '#7c3aed';
      ctx.fillRect(x + 18, y + 8, 4, 6);
      ctx.fillStyle = '#fbbf24';
      ctx.beginPath();
      ctx.arc(x + 20, y + 6, 3, 0, Math.PI * 2);
      ctx.fill();
      
      // Scribbles arms
      ctx.fillStyle = '#7c3aed';
      ctx.fillRect(x + 2, y + 20, 4, 8);
      ctx.fillRect(x + 34, y + 20, 4, 8);
    }

    function drawPipe(x, topHeight) {
      const gap = 150;
      const pipeWidth = 60;
      
      // Top pipe
      ctx.fillStyle = '#7c3aed';
      ctx.fillRect(x, 0, pipeWidth, topHeight);
      ctx.fillStyle = '#a78bfa';
      ctx.fillRect(x - 5, topHeight - 20, pipeWidth + 10, 20);
      
      // Bottom pipe
      ctx.fillRect(x, topHeight + gap, pipeWidth, canvas.height - topHeight - gap);
      ctx.fillRect(x - 5, topHeight + gap, pipeWidth + 10, 20);
    }

    function updateGame() {
      if (!gameRunning) return;

      // Clear canvas
      ctx.fillStyle = '#0a0a0a';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Update Scribbles
      scribbles.velocity += scribbles.gravity;
      scribbles.y += scribbles.velocity;

      // Draw Scribbles
      drawScribbles(scribbles.x, scribbles.y);

      // Add pipes
      frameCount++;
      if (frameCount % 90 === 0) {
        const topHeight = Math.random() * (canvas.height - 250) + 50;
        pipes.push({ x: canvas.width, topHeight: topHeight, scored: false });
      }

      // Update and draw pipes
      for (let i = pipes.length - 1; i >= 0; i--) {
        const pipe = pipes[i];
        pipe.x -= 3;

        drawPipe(pipe.x, pipe.topHeight);

        // Check collision
        const gap = 150;
        if (scribbles.x + scribbles.width > pipe.x && scribbles.x < pipe.x + 60) {
          if (scribbles.y < pipe.topHeight || scribbles.y + scribbles.height > pipe.topHeight + gap) {
            endGame();
            return;
          }
        }

        // Score
        if (!pipe.scored && pipe.x + 60 < scribbles.x) {
          pipe.scored = true;
          gameScore++;
        }

        // Remove off-screen pipes
        if (pipe.x + 60 < 0) {
          pipes.splice(i, 1);
        }
      }

      // Check boundaries
      if (scribbles.y + scribbles.height > canvas.height || scribbles.y < 0) {
        endGame();
        return;
      }

      // Draw score
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 24px system-ui';
      ctx.fillText(`Score: ${gameScore}`, 20, 40);
    }

    function startGame() {
      gameRunning = true;
      gameScore = 0;
      scribbles.y = 250;
      scribbles.velocity = 0;
      pipes = [];
      frameCount = 0;
      document.getElementById('game-over-screen').style.display = 'none';
      
      if (gameInterval) clearInterval(gameInterval);
      gameInterval = setInterval(updateGame, 1000 / 60);
    }

    function endGame() {
      gameRunning = false;
      clearInterval(gameInterval);
      document.getElementById('final-score').textContent = gameScore;
      document.getElementById('game-over-screen').style.display = 'flex';
    }

    function restartGame() {
      startGame();
    }

    function scribblesJump() {
      if (gameRunning) {
        scribbles.velocity = scribbles.jump;
      } else {
        startGame();
      }
    }

    // Game controls
    canvas.addEventListener('click', scribblesJump);
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space' && currentPanel === 'break') {
        e.preventDefault();
        scribblesJump();
      }
    });

    // Draw initial Scribbles
    ctx.fillStyle = '#0a0a0a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    drawScribbles(scribbles.x, scribbles.y);
    ctx.fillStyle = '#ffffff';
    ctx.font = 'bold 20px system-ui';
    ctx.fillText('Click or press Space to start!', 70, 250);

    // Initialize
    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a920fb8b19a675f',t:'MTc2NDkyMjE2Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
